<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>跑团♂里不是这样的</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Microsoft YaHei", sans-serif;
    }
    body {
      background-color: #121212;
      color: #ffffff;
      padding: 10px;
      max-width: 600px;
      margin: 0 auto;
    }
    .game-title {
      text-align: center;
      color: #ffd700;
      margin: 20px 0;
      font-size: 22px;
      line-height: 1.4;
    }
    .game-desc {
      text-align: center;
      margin-bottom: 20px;
      color: #cccccc;
      font-size: 14px;
    }
    .question-area {
      background-color: #2a2a2a;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
    }
    .question-text {
      font-size: 18px;
      margin-bottom: 10px;
      color: #ffffff;
    }
    .round-info {
      font-size: 14px;
      color: #999999;
    }
    .options-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 15px;
    }
    .option-btn {
      background-color: #3a3a3a;
      border: none;
      border-radius: 6px;
      padding: 12px;
      color: #ffffff;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .option-btn:hover {
      background-color: #4a4a4a;
    }
    .option-btn.correct {
      background-color: #2ecc71;
    }
    .option-btn.wrong {
      background-color: #e74c3c;
    }
    .message-box {
      background-color: #2a2a2a;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 15px;
      text-align: center;
      font-size: 16px;
    }
    .msg-normal {
      color: #cccccc;
    }
    .msg-win {
      color: #2ecc71;
    }
    .msg-lose {
      color: #e74c3c;
    }
    .status-bar {
      display: flex;
      justify-content: space-between;
      background-color: #2a2a2a;
      border-radius: 8px;
      padding: 12px 15px;
      margin-bottom: 15px;
    }
    .status-item {
      text-align: center;
    }
    .status-label {
      font-size: 14px;
      color: #999999;
      margin-bottom: 5px;
    }
    .status-value {
      font-size: 20px;
      font-weight: bold;
      color: #ffd700;
    }
    /* 广告区域基础样式 */
    .ad-section {
      background-color: #2a2a2a;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 15px;
      position: relative;
    }
    .ad-close-btn {
      position: absolute;
      top: 8px;
      left: 8px;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: #e74c3c;
      color: #fff;
      border: none;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .ad-title {
      text-align: center;
      margin: 10px 0;
      color: #ffd700;
      font-size: 16px;
    }
    .ad-cta {
      display: block;
      width: 100%;
      padding: 10px;
      background-color: #e67e22;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      text-decoration: none;
      margin-top: 10px;
      font-weight: bold;
    }
    .ad-img-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.9);
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .ad-img-close {
      position: absolute;
      top: 20px;
      right: 20px;
      color: #fff;
      font-size: 24px;
      cursor: pointer;
    }
    .ad-img-content {
      max-width: 100%;
      max-height: 80vh;
    }
    /* 成就墙样式 */
    .achievement-wall {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.95);
      z-index: 1000;
      padding: 20px;
      display: none;
      overflow-y: auto;
    }
    .achievement-wall-close {
      text-align: right;
      font-size: 24px;
      cursor: pointer;
      margin-bottom: 20px;
      color: #ffd700;
    }
    .achievement-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
    }
    .achievement-item {
      background-color: #2a2a2a;
      border-radius: 8px;
      padding: 15px;
      text-align: center;
    }
    .achievement-name {
      color: #ffd700;
      font-weight: bold;
      margin-bottom: 5px;
    }
    .achievement-desc {
      font-size: 12px;
      color: #cccccc;
    }
    /* 弹窗基础样式 */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
      z-index: 999;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .modal-content {
      background-color: #2a2a2a;
      border-radius: 8px;
      padding: 20px;
      max-width: 400px;
      width: 100%;
    }
    .modal-title {
      color: #ffd700;
      margin-bottom: 15px;
      text-align: center;
    }
    .modal-btn-group {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      justify-content: center;
    }
    .modal-btn {
      padding: 8px 15px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }
    .modal-btn-confirm {
      background-color: #e74c3c;
      color: #fff;
    }
    .modal-btn-cancel {
      background-color: #3a3a3a;
      color: #fff;
    }
  </style>
</head>
<body>
  <h1 class="game-title">跑团♂里不是这样的，我不接受!</h1>
  <p class="game-desc">点击正确选项，赢取分数</p>

  <div class="question-area">
    <p class="question-text" id="questionText">准备开始游戏</p>
    <p class="round-info">关卡: <span id="roundNum">0</span></p>
  </div>

  <div class="options-grid" id="optionsGrid"></div>

  <div class="message-box msg-normal" id="messageBox">点击「开始游戏」开始挑战</div>

  <div class="status-bar">
    <div class="status-item">
      <p class="status-label">分数</p>
      <p class="status-value" id="scoreNum">0</p>
    </div>
    <div class="status-item">
      <p class="status-label">倒计时</p>
      <p class="status-value" id="timerNum">---</p>
    </div>
  </div>
<!-- 功能按键容器（手机端横向布局+样式适配） -->
  <div id="gameBtnContainer" style="position: relative; display: flex; gap: 6px; margin: 15px 0; padding: 0 8px; box-sizing: border-box;">
    <!-- 开始游戏主按钮（金色背景） -->
    <button id="startBtn" style="background: #ffd700; color: #000; border: none; padding: 18px 0; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; flex: 1; text-align: center; touch-action: manipulation; line-height: 1.2;">开始游戏</button>
    <!-- 重置游戏按钮（深灰背景） -->
    <button id="resetBtn" style="background: #3a3a3a; color: #fff; border: none; padding: 18px 0; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; flex: 1; text-align: center; touch-action: manipulation; line-height: 1.2;">重置游戏</button>
    <!-- 成就墙按钮（深灰背景） -->
    <button id="achievementBtn" style="background: #3a3a3a; color: #fff; border: none; padding: 18px 0; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; flex: 1; text-align: center; touch-action: manipulation; line-height: 1.2;">成就墙</button>
    <!-- 重置成就按钮（深灰背景） -->
    <button id="resetAchieveBtn" style="background: #3a3a3a; color: #fff; border: none; padding: 18px 0; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; flex: 1; text-align: center; touch-action: manipulation; line-height: 1.2;">重置成就</button>
  </div>
<!-- 原有广告区域：显示广告封面GIF -->
  <div class="ad-section" id="originalAd">
    <button class="ad-close-btn" id="originalAdClose">×</button>
    <h3 class="ad-title">广告封面</h3>
    <img src="ad_cover.gif" alt="广告封面" style="width: 100%; border-radius: 6px;" id="adCoverGif">
    <a href="javascript:;" class="ad-cta" id="originalAdCta">点击查看随机广告图</a>
  </div>

  <!-- 新广告区域 -->
  <div class="ad-section" id="newAd">
    <button class="ad-close-btn" id="newAdClose">×</button>
    <h3 class="ad-title">♂♂火热换装 在线漫画♂♂</h3>
    <a href="javascript:;" class="ad-cta" id="newAdCta">点击查看潮流穿搭</a>
  </div>

  <!-- 新增：玩家评论区（Utterances异地互通） -->
  <div class="comment-section" style="margin-top: 20px; padding: 16px; background: #2d2d2d; border-radius: 12px; max-width: 100%; overflow: hidden;">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
      <h3 style="font-size: 18px; color: #ffd700; margin: 0;">玩家评论区</h3>
      <button id="toggleCommentBtn" style="background: #ffd700; color: #000; border: none; padding: 5px 10px; border-radius: 4px; font-size: 12px; cursor: pointer; touch-action: manipulation;">折叠更多</button>
    </div>
    <div id="commentContent" style="max-height: 240px; overflow-y: auto; transition: max-height 0.3s ease; width: 100%;">
      <script src="https://utteranc.es/client.js"
        repo="weique908-hash/GAY"
        issue-term="title"
        theme="github-dark"
        crossorigin="anonymous"
        async>
      </script>
      <p style="font-size: 12px; color: #aaaaaa; margin-top: 10px; text-align: right; padding-right: 5px;">*仓库所有者可在GitHub Issues中删除评论</p>
    </div>
  </div>
<!-- 广告确认弹窗 -->
  <div class="modal-overlay hidden-cls" id="adConfirmModal">
    <div class="modal-content">
      <h3 class="modal-title">确认查看广告？</h3>
      <div class="modal-btn-group">
        <button class="modal-btn modal-btn-confirm" id="adConfirmBtn">确认</button>
        <button class="modal-btn modal-btn-cancel" id="adCancelBtn">取消</button>
      </div>
    </div>
  </div>

  <!-- 广告图片弹窗 -->
  <div class="ad-img-modal" id="adImgModal">
    <span class="ad-img-close" id="adImgCloseBtn">×</span>
    <img src="" alt="广告图片" class="ad-img-content" id="adImgContent">
  </div>

  <!-- 重置成就确认弹窗 -->
  <div class="modal-overlay hidden-cls" id="resetAchieveModal">
    <div class="modal-content">
      <h3 class="modal-title">确认重置所有成就？</h3>
      <div class="modal-btn-group">
        <button class="modal-btn modal-btn-confirm" id="resetAchieveConfirm">确认</button>
        <button class="modal-btn modal-btn-cancel" id="resetAchieveYeah">取消</button>
      </div>
    </div>
  </div>

  <!-- 成就墙弹窗 -->
  <div class="achievement-wall" id="achievementWall">
    <div class="achievement-wall-close" id="achievementWallClose">×</div>
    <h2 class="modal-title">成就墙</h2>
    <div class="achievement-list" id="achievementList"></div>
  </div>

  <!-- 成就解锁弹窗 -->
  <div class="modal-overlay hidden-cls" id="achievementModal">
    <div class="modal-content">
      <h3 class="modal-title" id="modalAchievementName">成就解锁！</h3>
      <p id="modalAchievementDesc" style="text-align: center; color: #ccc;"></p>
      <div class="modal-btn-group">
        <button class="modal-btn modal-btn-cancel" id="modalAchievementClose">关闭</button>
      </div>
    </div>
  </div>
<style>
    /* 功能按钮适配：解决文字换行与触控反馈（追加样式） */
    #gameBtnContainer button {
      white-space: normal;
      word-wrap: break-word;
      min-height: 60px;
    }
    #startBtn {
      box-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
    }
    #startBtn:active, #resetBtn:active, #achievementBtn:active, #resetAchieveBtn:active {
      transform: scale(0.98);
      opacity: 0.9;
      transition: all 0.1s ease;
    }
    /* 手机端小屏适配：缩小按钮内边距与字号 */
    @media (max-width: 360px) {
      #gameBtnContainer button {
        padding: 14px 0;
        font-size: 14px;
        min-height: 50px;
      }
    }
    /* 评论区折叠样式（追加） */
    #toggleCommentBtn:hover {
      opacity: 0.9;
    }
    #toggleCommentBtn:active {
      transform: scale(0.95);
    }
  </style>

  <script>
    // ========== 游戏数据 ==========
    const questions = [
      {
        text: "跑团中PL的行为被称为？",
        options: ["角色扮演", "撕卡", "车卡", "骰娘"],
        answer: 0
      },
      {
        text: "COC跑团中常用的骰子是？",
        options: ["D20", "D100", "D6", "D8"],
        answer: 1
      },
      {
        text: "跑团中KP的职责是？",
        options: ["扮演NPC", "只投骰子", "挂机", "抢PL装备"],
        answer: 0
      },
      {
        text: "车卡指的是？",
        options: ["制作角色卡", "开车撞卡", "撕毁角色卡", "收藏卡片"],
        answer: 0
      },
      {
        text: "跑团中“撕卡”意味着？",
        options: ["角色死亡", "卡片被撕", "退出游戏", "换卡"],
        answer: 0
      }
    ];

    // ========== 成就数据 ==========
    const achievements = [
      {
        id: "first_win",
        name: "初次告捷",
        desc: "答对第一个问题",
        unlocked: false
      },
      {
        id: "ten_point",
        name: "十分大佬",
        desc: "分数达到10分",
        unlocked: false
      },
      {
        id: "all_correct",
        name: "全知全能",
        desc: "连续答对所有问题",
        unlocked: false
      },
      {
        id: "fast_hand",
        name: "手速达人",
        desc: "5秒内答对问题",
        unlocked: false
      },
      {
        id: "ad_viewer",
        name: "广告鉴赏家",
        desc: "查看1次广告",
        unlocked: false
      }
    ];

    // ========== DOM元素 ==========
    const el = {
      questionText: document.getElementById('questionText'),
      roundNum: document.getElementById('roundNum'),
      optionsGrid: document.getElementById('optionsGrid'),
      messageBox: document.getElementById('messageBox'),
      scoreNum: document.getElementById('scoreNum'),
      timerNum: document.getElementById('timerNum'),
      startBtn: document.getElementById('startBtn'),
      resetBtn: document.getElementById('resetBtn'),
      achievementBtn: document.getElementById('achievementBtn'),
      resetAchieveBtn: document.getElementById('resetAchieveBtn'),
      originalAd: document.getElementById('originalAd'),
      originalAdClose: document.getElementById('originalAdClose'),
      originalAdCta: document.getElementById('originalAdCta'),
      newAd: document.getElementById('newAd'),
      newAdClose: document.getElementById('newAdClose'),
      newAdCta: document.getElementById('newAdCta'),
      adCoverGif: document.getElementById('adCoverGif'),
      adConfirmModal: document.getElementById('adConfirmModal'),
      adConfirmBtn: document.getElementById('adConfirmBtn'),
      adCancelBtn: document.getElementById('adCancelBtn'),
      adImgModal: document.getElementById('adImgModal'),
      adImgCloseBtn: document.getElementById('adImgCloseBtn'),
      adImgContent: document.getElementById('adImgContent'),
      resetAchieveModal: document.getElementById('resetAchieveModal'),
      resetAchieveConfirm: document.getElementById('resetAchieveConfirm'),
      resetAchieveYeah: document.getElementById('resetAchieveYeah'),
      achievementWall: document.getElementById('achievementWall'),
      achievementWallClose: document.getElementById('achievementWallClose'),
      achievementList: document.getElementById('achievementList'),
      achievementModal: document.getElementById('achievementModal'),
      modalAchievementName: document.getElementById('modalAchievementName'),
      modalAchievementDesc: document.getElementById('modalAchievementDesc'),
      modalAchievementClose: document.getElementById('modalAchievementClose'),
      toggleCommentBtn: document.getElementById('toggleCommentBtn'),
      commentContent: document.getElementById('commentContent')
    };

    // ========== 游戏状态 ==========
    let gameState = {
      currentRound: 0,
      score: 0,
      timer: null,
      timeLeft: 10,
      isPlaying: false,
      adViewCount: 0,
      achievements: JSON.parse(localStorage.getItem('gameAchievements')) || [...achievements]
    };

    // ========== 工具函数 ==========
    function showMessage(text, type = 'normal') {
      el.messageBox.textContent = text;
      el.messageBox.className = `message-box msg-${type}`;
    }

    function updateScore() {
      el.scoreNum.textContent = gameState.score;
      checkAchievements();
    }

    function updateRound() {
      el.roundNum.textContent = gameState.currentRound;
    }

    function startTimer() {
      clearInterval(gameState.timer);
      gameState.timeLeft = 10;
      el.timerNum.textContent = gameState.timeLeft;
      gameState.timer = setInterval(() => {
        gameState.timeLeft--;
        el.timerNum.textContent = gameState.timeLeft;
        if (gameState.timeLeft <= 0) {
          clearInterval(gameState.timer);
          showMessage('时间到！', 'lose');
          nextRound();
        }
      }, 1000);
    }

    function nextRound() {
      clearInterval(gameState.timer);
      gameState.currentRound++;
      if (gameState.currentRound >= questions.length) {
        showMessage(`游戏结束！最终分数：${gameState.score}`, 'win');
        gameState.isPlaying = false;
        el.startBtn.disabled = false;
        checkAchievements('all_correct');
        return;
      }
      updateRound();
      loadQuestion();
      startTimer();
    }

    function loadQuestion() {
      const q = questions[gameState.currentRound];
      el.questionText.textContent = q.text;
      el.optionsGrid.innerHTML = '';
      q.options.forEach((opt, idx) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.textContent = opt;
        btn.addEventListener('click', () => checkAnswer(idx));
        el.optionsGrid.appendChild(btn);
      });
    }

    function checkAnswer(idx) {
      if (!gameState.isPlaying) return;
      clearInterval(gameState.timer);
      const q = questions[gameState.currentRound];
      const options = el.optionsGrid.querySelectorAll('.option-btn');
      if (idx === q.answer) {
        options[idx].classList.add('correct');
        gameState.score += 2;
        showMessage('答对了！', 'win');
        if (gameState.timeLeft >= 5) checkAchievements('fast_hand');
        checkAchievements('first_win');
      } else {
        options[idx].classList.add('wrong');
        options[q.answer].classList.add('correct');
        showMessage('答错了！', 'lose');
      }
      updateScore();
      setTimeout(nextRound, 1500);
    }

    // ========== 成就系统 ==========
    function checkAchievements(achId) {
      // 检查分数成就
      if (gameState.score >= 10) unlockAchievement('ten_point');
      // 检查指定成就
      if (achId) unlockAchievement(achId);
      // 保存成就到本地
      localStorage.setItem('gameAchievements', JSON.stringify(gameState.achievements));
    }

    function unlockAchievement(achId) {
      const ach = gameState.achievements.find(a => a.id === achId);
      if (ach && !ach.unlocked) {
        ach.unlocked = true;
        showAchievementModal(ach);
      }
    }

    function showAchievementModal(ach) {
      el.modalAchievementName.textContent = `解锁成就：${ach.name}`;
      el.modalAchievementDesc.textContent = ach.desc;
      el.achievementModal.style.display = 'flex';
    }

    function renderAchievementWall() {
      el.achievementList.innerHTML = '';
      gameState.achievements.forEach(ach => {
        const item = document.createElement('div');
        item.className = 'achievement-item';
        item.innerHTML = `
          <p class="achievement-name">${ach.name}</p>
          <p class="achievement-desc">${ach.desc}</p>
          <p style="font-size:10px; color: ${ach.unlocked ? '#2ecc71' : '#e74c3c'}">${ach.unlocked ? '已解锁' : '未解锁'}</p>
        `;
        el.achievementList.appendChild(item);
      });
    }

    // ========== 广告相关 ==========
    function openAdModal() {
      el.adConfirmModal.style.display = 'flex';
    }

    function showRandomAd() {
      const adImgs = ['ad1.jpg', 'ad2.jpg', 'ad3.jpg'];
      const randomImg = adImgs[Math.floor(Math.random() * adImgs.length)];
      el.adImgContent.src = randomImg;
      el.adImgModal.style.display = 'flex';
      gameState.adViewCount++;
      checkAchievements('ad_viewer');
    }

    // ========== 评论区折叠 ==========
    let commentCollapsed = true;
    function toggleComment() {
      if (commentCollapsed) {
        el.commentContent.style.maxHeight = '500px';
        el.toggleCommentBtn.textContent = '折叠更多';
      } else {
        el.commentContent.style.maxHeight = '240px';
        el.toggleCommentBtn.textContent = '展开全部';
      }
      commentCollapsed = !commentCollapsed;
    }

    // ========== 事件绑定 ==========
    function bindEvents() {
      // 游戏按钮
      el.startBtn.addEventListener('click', () => {
        if (gameState.isPlaying) return;
        gameState.isPlaying = true;
        gameState.currentRound = 0;
        gameState.score = 0;
        updateScore();
        updateRound();
        loadQuestion();
        startTimer();
        showMessage('游戏开始！', 'normal');
        el.startBtn.disabled = true;
      });

      el.resetBtn.addEventListener('click', () => {
        clearInterval(gameState.timer);
        gameState.isPlaying = false;
        gameState.currentRound = 0;
        gameState.score = 0;
        updateScore();
        updateRound();
        el.questionText.textContent = '准备开始游戏';
        el.optionsGrid.innerHTML = '';
        el.timerNum.textContent = '---';
        showMessage('点击「开始游戏」开始挑战', 'normal');
        el.startBtn.disabled = false;
      });

      // 成就按钮
      el.achievementBtn.addEventListener('click', () => {
        renderAchievementWall();
        el.achievementWall.style.display = 'block';
      });

      el.achievementWallClose.addEventListener('click', () => {
        el.achievementWall.style.display = 'none';
      });

      el.resetAchieveBtn.addEventListener('click', () => {
        el.resetAchieveModal.style.display = 'flex';
      });

      el.resetAchieveConfirm.addEventListener('click', () => {
        gameState.achievements = [...achievements];
        localStorage.setItem('gameAchievements', JSON.stringify(gameState.achievements));
        el.resetAchieveModal.style.display = 'none';
        showMessage('成就已重置！', 'normal');
      });

      el.resetAchieveYeah.addEventListener('click', () => {
        el.resetAchieveModal.style.display = 'none';
      });

      // 成就弹窗
      el.modalAchievementClose.addEventListener('click', () => {
        el.achievementModal.style.display = 'none';
      });

      // 广告相关
      el.originalAdClose.addEventListener('click', () => {
        el.originalAd.style.display = 'none';
      });

      el.newAdClose.addEventListener('click', () => {
        el.newAd.style.display = 'none';
      });

      el.originalAdCta.addEventListener('click', openAdModal);
      el.newAdCta.addEventListener('click', openAdModal);

      el.adConfirmBtn.addEventListener('click', () => {
        el.adConfirmModal.style.display = 'none';
        showRandomAd();
      });

      el.adCancelBtn.addEventListener('click', () => {
        el.adConfirmModal.style.display = 'none';
      });

      el.adImgCloseBtn.addEventListener('click', () => {
        el.adImgModal.style.display = 'none';
      });

      // 评论区折叠
      el.toggleCommentBtn.addEventListener('click', toggleComment);
    }

    // ========== 初始化 ==========
    function init() {
      bindEvents();
      updateScore();
      updateRound();
      // 初始化评论区高度
      el.commentContent.style.maxHeight = '240px';
    }

    // 页面加载完成后初始化
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>