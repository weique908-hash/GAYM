<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <!-- å¼ºåˆ¶ç§»åŠ¨ç«¯é€‚é…ï¼Œç¦ç”¨ç¼©æ”¾ -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ä½ å¥½å•Šæˆ‘æ˜¯ç”·åŒ</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#ffb86b;--muted:#94a3b8;--win:#34d399;--lose:#fb7185;font-family:Inter,system-ui,Arial}
    html,body{height:100%;margin:0;padding:16px;background:linear-gradient(180deg,var(--bg),#071025);color:#e6eef8;display:flex;align-items:center;justify-content:center}
    .card{width:100%;max-width:760px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:14px;border:1px solid rgba(255,255,255,0.03)}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
    h1{font-size:18px;margin:0}
    .game-area{display:flex;flex-direction:column;gap:12px}
    .board{padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.02)}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}
    .cell{background:#0c1220;border-radius:8px;padding:6px;display:flex;align-items:center;justify-content:center;min-height:120px;cursor:pointer;/* å¼ºåˆ¶å…è®¸è§¦æ‘¸ */pointer-events:auto !important;position:relative;z-index:10}
    .cell img{max-width:100%;max-height:100%;object-fit:contain;border-radius:6px}
    .sidebar{display:flex;flex-direction:row;gap:10px;width:100%}
    .stat{flex:1;background:rgba(255,255,255,0.02);padding:8px;border-radius:8px;text-align:center}
    .stat-label{font-size:12px;color:var(--muted)}
    .stat-value{font-size:18px;font-weight:700}
    .controls{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
    .btn{background:var(--accent);border:none;padding:8px 10px;border-radius:8px;font-weight:700;cursor:pointer;/* å¼ºåˆ¶å…è®¸è§¦æ‘¸ */pointer-events:auto !important;position:relative;z-index:10}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--accent)}
    .message{padding:8px;border-radius:8px;text-align:center;margin:8px 0;display:none}
    .message.win{color:var(--win);display:block}
    .message.lose{color:var(--lose);display:block}
    .message.limit{color:var(--accent);font-size:16px;font-weight:700;animation:pulse 0.5s ease-in-out infinite alternate;background:rgba(255,184,107,0.1);border:1px solid rgba(255,184,107,0.3);display:block}
    @keyframes pulse{from{transform:scale(1);opacity:0.9}to{transform:scale(1.05);opacity:1}}
    .score-notice{position:fixed;top:20px;left:50%;transform:translateX(-50%);background:rgba(15,23,36,0.95);border:2px solid var(--accent);border-radius:8px;padding:12px 20px;font-size:18px;font-weight:700;color:var(--accent);z-index:999;animation:popup 0.3s ease-in-out;display:none}
    .score-notice.show{display:block}
    @keyframes popup{0%{opacity:0;transform:translateX(-50%) translateY(-20px)}100%{opacity:1;transform:translateX(-50%) translateY(0)}}
    /* å¹¿å‘ŠåŒºåŸŸ */
    footer.ad{margin-top:12px;padding:12px;border-radius:10px;display:flex;justify-content:space-between;align-items:center;position:relative}
    .ad-close-btn{position:absolute;top:6px;right:6px;background:var(--lose);color:white;border:none;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:14px;z-index:10;/* å¼ºåˆ¶å…è®¸è§¦æ‘¸ */pointer-events:auto !important}
    .cta{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:10px;background:var(--accent);color:#071025;font-weight:700;text-decoration:none;/* å¼ºåˆ¶å…è®¸è§¦æ‘¸ */pointer-events:auto !important}
    .flash{animation:flash 1s linear infinite}
    @keyframes flash{0%,100%{opacity:1}50%{opacity:0.25}}
    /* æ¨¡æ€æ¡†æ ·å¼ï¼ˆç®€åŒ–ï¼Œå¼ºåˆ¶è§¦æ‘¸ï¼‰ */
    .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:1000;align-items:center;justify-content:center}
    .modal.show{display:flex}
    .modal-content{background:var(--card);padding:20px;border-radius:12px;width:90%;max-width:400px;border:1px solid rgba(255,255,255,0.05)}
    .modal-title{font-size:16px;margin:0 0 12px;color:var(--acpx;color:var(--accent);text-align:center}
    .modal-buttons{display:flex;flex-direction:column;gap:8px}
    .modal-btn{padding:10px 16px;border-radius:8px;border:none;font-weight:700;cursor:pointer;text-align:center;/* å¼ºåˆ¶å…è®¸è§¦æ‘¸ */pointer-events:auto !important;position:relative;z-index:1001}
    .modal-btn.option1{background:var(--win);color:#071025}
    .modal-btn.option2{background:var(--lose);color:white}
    .modal-btn.option3{background:var(--accent);color:#071025}
  </style>
</head>
<body>
  <div class="card">
    <header>
      <h1>ä½ å¥½å•Šæˆ‘æ˜¯ç”·åŒ</h1>
      <div style="font-size:12px;color:var(--muted)">ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"æŒ‘æˆ˜</div>
    </header>

    <div class="game-area">
      <div class="board">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <div style="font-size:13px;color:var(--muted)">å…³å¡ï¼š<span id="round">â€”</span></div>
          <div id="questionText" style="font-size:13px;color:var(--muted)">é¢˜ç›®å°†éšæœºå‡ºç°</div>
        </div>

        <div id="grid" class="grid"></div>
        <div id="message" class="message"></div>
        <div class="controls">
          <button id="btnStart" class="btn">å¼€å§‹â™‚æ¸¸æˆ</button>
          <button id="btnRestart" class="btn secondary">é‡ç½®</button>
          <button id="btnEndGame" class="btn secondary">ç»“æŸæ¸¸æˆ</button>
        </div>
      </div>

      <div class="sidebar">
        <div class="stat">
          <div class="stat-label">å€’è®¡æ—¶</div>
          <div id="timer" class="stat-value">--</div>
        </div>
        <div class="stat">
          <div class="stat-label">åˆ†æ•°</div>
          <div id="score" class="stat-value">0</div>
        </div>
      </div>
    </div>

    <!-- å¹¿å‘ŠåŒºåŸŸ -->
    <footer class="ad">
      <button id="adCloseBtn" class="ad-close-btn">Ã—</button>
      <div style="font-size:13px;color:var(--muted)">å¹¿å‘ŠåŒº</div>
      <a class="cta flash" href="https://ä½ çš„æ¨å¹¿é“¾æ¥.com">ç‚¹å‡»â™‚è¿™é‡Œ</a>
    </footer>
  </div>

  <!-- å¹¿å‘Šå…³é—­ç¡®è®¤æ¨¡æ€æ¡† -->
  <div id="adCloseModal" class="modal">
    <div class="modal-content">
      <h3 class="modal-title">ä¸è¿›æ¥çœ‹çœ‹å—ï¼Ÿ</h3>
      <div class="modal-buttons">
        <button id="btnAdOption1" class="modal-btn option1">å¥½å§ï¼Œæ¥äº†â¤ï¸</button>
        <button id="btnAdOption2" class="modal-btn option2">å‘ƒâ†“ï¼Œæˆ‘æ˜¯ç›´ç”·ã€‚</button>
        <button id="btnAdOption3" class="modal-btn option3">ä½ ä¸çœ‹çœ‹æˆ‘å—ï¼Ÿ</button>
      </div>
    </div>
  </div>

  <div id="scoreNotice" class="score-notice"></div>

  <script>
    // ç­‰å¾…DOMå®Œå…¨åŠ è½½ï¼ˆå…¼å®¹æ‰€æœ‰æµè§ˆå™¨ï¼‰
    window.onload = function() {
      // 1. åŸºç¡€é…ç½®ï¼ˆç®€åŒ–ï¼Œé¿å…å˜é‡å†²çªï¼‰
      const CONFIG = {
        images: ["img1.jpg", "img2.jpg", "img3.jpg", "img4.jpg"],
        adLink: "https://ä½ çš„æ¨å¹¿é“¾æ¥.com",
        timeLimit: 8,
        maxScore: 100,
        pointsPerCorrect: 5
      };

      // 2. é¢˜ç›®é…ç½®ï¼ˆä¿ç•™æ ¸å¿ƒï¼‰
      const QUESTIONS = [
        {
          text: 'æ‰¾å‡ºé‡Œé¢æ‰€æœ‰ç”·åŒ',
          type: 'special',
          onSelect: () => ({ ok: false, msg: 'å“ˆå“ˆéª—ä½ çš„ï¼Œæˆ‘åªè®¾ç½®äº†å•é€‰' })
        },
        {
          text: 'æ‰¾å‡ºçœŸæ­£çš„å¨å¸ˆ',
          type: 'single',
          correctIdx: 0,
          onCorrect: 'ä½ çœ‹èµ·æ¥å¾ˆå¥½åƒ',
          onWrong: 'Cazzoï¼Œä½ ä¸è®¤è¯†æˆ‘å—'
        },
        {
          text: 'æ‰¾å‡ºå¤±å»äº†çƒæ£çš„å¿ƒç†æ²»ç–—å¸ˆ',
          type: 'single',
          correctIdx: 3,
          onCorrect: 'éš”å£ä»–ç”·äººåœ¨åŒæŒing',
          onWrong: 'å†é€‰é”™å°±è¿‡æ¥å¿ƒç†æ²»ç–—'
        },
        {
          text: 'æ‰¾å‡ºå›¾ä¸­çš„ç›´ç”·',
          type: 'multi-text',
          onSelect: (idx) => {
            if (idx === 0 || idx === 1) {
              return { ok: true, msg: 'ğŸ’æˆ‘ä»¬æ˜¯çœŸæ­£çš„â™‚ç›´ç”·â™‚å‘€' };
            } else {
              return { ok: true, msg: 'ğŸŒˆğŸŒˆğŸŒˆéª„å‚²ä¹‹â™‚GAYğŸŒˆğŸŒˆğŸŒˆ' };
            }
          }
        }
      ];

      // 3. è·å–DOMå…ƒç´ ï¼ˆç¡®ä¿æ‰€æœ‰å…ƒç´ å­˜åœ¨ï¼‰
      const gridEl = document.getElementById('grid');
      const timerEl = document.getElementById('timer');
      const scoreEl = document.getElementById('score');
      const messageEl = document.getElementById('message');
      const questionTextEl = document.getElementById('questionText');
      const roundEl = document.getElementById('round');
      const btnStart = document.getElementById('btnStart');
      const btnRestart = document.getElementById('btnRestart');
      const btnEndGame = document.getElementById('btnEndGame');
      const adCloseBtn = document.getElementById('adCloseBtn');
      const adCloseModal = document.getElementById('adCloseModal');
      const btnAdOption1 = document.getElementById('btnAdOption1');
      const btnAdOption2 = document.getElementById('btnAdOption2');
      const btnAdOption3 = document.getElementById('btnAdOption3');
      const scoreNoticeEl = document.getElementById('scoreNotice');

      // 4. æ¸¸æˆçŠ¶æ€ï¼ˆç®€åŒ–ï¼Œé¿å…çŠ¶æ€æ··ä¹±ï¼‰
      let timeLeft = CONFIG.timeLimit;
      let timer = null;
      let score = 0;
      let round = 0;
      let currentQuestion = null;
      let playable = false;
      let gameActive = false;

      // 5. æ ¸å¿ƒå·¥å…·å‡½æ•°
      // æ˜¾ç¤ºæç¤º
      function showNotice(text) {
        scoreNoticeEl.textContent = text;
        scoreNoticeEl.classList.add('show');
        setTimeout(() => scoreNoticeEl.classList.remove('show'), 3000);
      }

      // æ˜¾ç¤ºæ¶ˆæ¯
      function showMessage(text, type) {
        messageEl.textContent = text;
        messageEl.className = 'message';
        if (type === 'win') messageEl.classList.add('win');
        else if (type === 'lose') messageEl.classList.add('lose');
        else if (type === 'limit') messageEl.classList.add('limit');
      }

      // éšæœºæ‰“ä¹±æ•°ç»„ï¼ˆå¸¦åŸç´¢å¼•ï¼‰
      function shuffleArr(arr) {
        const newArr = [...arr];
        const indexes = Array.from(arr.keys());
        for (let i = newArr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [newArr[i], newArr[j]] = [newArr[j], newArr[i]];
          [indexes[i], indexes[j]] = [indexes[j], indexes[i]];
        }
        return { arr: newArr, indexes };
      }

      // æ¸²æŸ“æ¸¸æˆç½‘æ ¼
      function renderGrid() {
        gridEl.innerHTML = '';
        const { arr: shuffledImgs, indexes: originalIndexes } = shuffleArr(CONFIG.images);
        shuffledImgs.forEach((imgSrc, i) => {
          const cell = document.createElement('div');
          cell.className = 'cell';
          cell.setAttribute('data-original-idx', originalIndexes[i]);
          const img = document.createElement('img');
          img.src = imgSrc;
          img.alt = `è§’è‰²${i+1}`;
          cell.appendChild(img);
          // ç»‘å®šè§¦æ‘¸+ç‚¹å‡»äº‹ä»¶ï¼ˆå¼ºåˆ¶è§¦å‘ï¼‰
          cell.ontouchend = (e) => {
            e.preventDefault();
            handleCellClick(cell);
          };
          cell.onclick = () => handleCellClick(cell);
          gridEl.appendChild(cell);
        });
      }

      // å¼€å§‹æ–°ä¸€è½®
      function startRound() {
        if (timer) clearInterval(timer);
        timeLeft = CONFIG.timeLimit;
        timerEl.textContent = `${timeLeft}s`;
        round++;
        roundEl.textContent = round;
        currentQuestion = QUESTIONS[Math.floor(Math.random() * QUESTIONS.length)];
        questionTextEl.textContent = currentQuestion.text;
        renderGrid();
        playable = true;
        showMessage('', '');

        // å€’è®¡æ—¶
        timer = setInterval(() => {
          timeLeft--;
          timerEl.textContent = `${timeLeft}s`;
          if (timeLeft <= 0) {
            clearInterval(timer);
            playable = false;
            showMessage('æ‚é±¼ æ…¢æ­»äº†', 'lose');
            setTimeout(() => gameActive && startRound(), 1300);
          }
        }, 1000);
      }

      // å¤„ç†å•å…ƒæ ¼ç‚¹å‡»
      function handleCellClick(cell) {
        if (!playable) return;
        playable = false;
        clearInterval(timer);
        const originalIdx = Number(cell.getAttribute('data-original-idx'));
        const res = currentQuestion.onSelect ? currentQuestion.onSelect(originalIdx) : null;

        if (currentQuestion.type === 'single') {
          if (originalIdx === currentQuestion.correctIdx) {
            if (score < CONFIG.maxScore) {
              score += CONFIG.pointsPerCorrect;
              scoreEl.textContent = score;
              showMessage(currentQuestion.onCorrect, 'win');
              showNotice(`+${CONFIG.pointsPerCorrect}åˆ†`);
            } else {
              showMessage('å·²ç»...æé™äº†â™‚â™‚â™‚', 'limit');
            }
          } else {
            showMessage(currentQuestion.onWrong, 'lose');
          }
        } else if (res) {
          res.ok ? showMessage(res.msg, 'win') : showMessage(res.msg, 'lose');
          if (res.ok && score < CONFIG.maxScore) {
            score += CONFIG.pointsPerCorrect;
            scoreEl.textContent = score;
            showNotice(`+${CONFIG.pointsPerCorrect}åˆ†`);
          }
        }

        setTimeout(() => gameActive && startRound(), 1300);
      }

      // é‡ç½®æ¸¸æˆ
      function resetGame() {
        if (timer) clearInterval(timer);
        round = 0;
        score = 0;
        timeLeft = CONFIG.timeLimit;
        timerEl.textContent = '--';
        scoreEl.textContent = '0';
        roundEl.textContent = 'â€”';
        gridEl.innerHTML = '';
        showMessage('ç‚¹å‡»"å¼€å§‹â™‚æ¸¸æˆ"å¼€å§‹æŒ‘æˆ˜', '');
        gameActive = false;
      }

      // ç»“æŸæ¸¸æˆ
      function endGame() {
        gameActive = false;
        if (timer) clearInterval(timer);
        playable = false;
        showMessage(`æ¸¸æˆç»“æŸï¼æœ€ç»ˆå¾—åˆ†ï¼š${score}åˆ†`, 'win');
        showNotice(`æ¸¸æˆç»“æŸï¼å¾—åˆ†ï¼š${score}`);
      }

      // 6. å¹¿å‘Šç›¸å…³é€»è¾‘
      function openAd() {
        const newTab = window.open(CONFIG.adLink, '_blank');
        !newTab && showNotice('è¯·å…è®¸å¼¹å‡ºçª—å£æŸ¥çœ‹å¹¿å‘Š');
        adCloseModal.classList.remove('show');
      }

      function closeAdWithInsult() {
        showNotice('æ”¾ä½ çš„å±ã€‚');
        adCloseModal.classList.remove('show');
        document.querySelector('footer.ad').style.display = 'none';
      }

      function closeAdWithTaunt() {
        showNotice('ä½ ç…å•¥ï¼Ÿ');
        adCloseModal.classList.remove('show');
        document.querySelector('footer.ad').style.display = 'none';
      }

      // 7. ç»‘å®šæ‰€æœ‰äº‹ä»¶ï¼ˆå¼ºåˆ¶è§¦æ‘¸ä¼˜å…ˆï¼‰
      // å¼€å§‹æ¸¸æˆ
      btnStart.ontouchend = (e) => {
        e.preventDefault();
        gameActive = true;
        startRound();
      };
      btnStart.onclick = () => {
        gameActive = true;
        startRound();
      };

      // é‡ç½®æ¸¸æˆ
      btnRestart.ontouchend = (e) => {
        e.preventDefault();
        resetGame();
      };
      btnRestart.onclick = resetGame;

      // ç»“æŸæ¸¸æˆ
      btnEndGame.ontouchend = (e) => {
        e.preventDefault();
        endGame();
      };
      btnEndGame.onclick = endGame;

      // å¹¿å‘Šå…³é—­æŒ‰é’®
      adCloseBtn.ontouchend = (e) => {
        e.preventDefault();
        adCloseModal.classList.add('show');
      };
      adCloseBtn.onclick = () => adCloseModal.classList.add('show');

      // å¹¿å‘Šæ¨¡æ€æ¡†é€‰é¡¹
      btnAdOption1.ontouchend = (e) => {
        e.preventDefault();
        openAd();
      };
      btnAdOption1.onclick = openAd;

      btnAdOption2.ontouchend = (e) => {
        e.preventDefault();
        closeAdWithInsult();
      };
      btnAdOption2.onclick = closeAdWithInsult;

      btnAdOption3.ontouchend = (e) => {
        e.preventDefault();
        closeAdWithTaunt();
      };
      btnAdOption3.onclick = closeAdWithTaunt;

      // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
      adCloseModal.ontouchend = (e) => {
        if (e.target === adCloseModal) adCloseModal.classList.remove('show');
      };
      adCloseModal.onclick = (e) => {
        if (e.target === adCloseModal) adCloseModal.classList.remove('show');
      };

      // åˆå§‹åŒ–
      resetGame();
    };
  </script>
</body>
</html>